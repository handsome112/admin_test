{"ast":null,"code":"var _jsxFileName = \"/var/www/admin.dtest.live/pages/payout-request/index.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { message } from 'antd';\nimport Head from 'next/head';\nimport { PureComponent } from 'react';\nimport { SearchFilter } from '@components/common/search-filter';\nimport { BreadcrumbComponent } from '@components/common';\nimport Page from '@components/common/layout/page';\nimport { getResponseError } from 'src/lib/utils';\nimport PayoutRequestTable from '@components/payout-request/table-list';\nimport { payoutRequestService } from 'src/services';\n\nclass PayoutRequestPage extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      data: [],\n      offset: 0,\n      pagination: {\n        total: 0,\n        pageSize: 10\n      },\n      sort: {\n        sortBy: 'createAt',\n        sorter: 'desc'\n      },\n      filter: {},\n      sourceType: 'performer'\n    };\n  }\n\n  componentDidMount() {\n    this.getList();\n  }\n\n  async getList() {\n    const {\n      filter,\n      offset,\n      data,\n      pagination,\n      sort,\n      query,\n      sourceType\n    } = this.state;\n\n    try {\n      const resp = await payoutRequestService.search(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, filter), sort), {}, {\n        offset\n      }, query), {}, {\n        sourceType,\n        limit: pagination.pageSize\n      }));\n      await this.setState({\n        data: resp.data.data,\n        pagination: _objectSpread(_objectSpread({}, pagination), {}, {\n          total: resp.data.total\n        })\n      });\n    } catch (e) {\n      this.showError(e);\n    } finally {\n      this.setState({\n        loading: false\n      });\n    }\n  }\n\n  async showError(e) {\n    const err = await Promise.resolve(e);\n    message.error(getResponseError(err));\n  }\n\n  async updateStatus(id, value) {\n    await payoutRequestService.update(id, {\n      status: value\n    });\n    this.getList();\n  }\n\n  async onHandleTabChange(pagination, filters, sorter) {\n    const {\n      sort\n    } = this.state;\n\n    if (filters && filters.length) {}\n\n    await this.setState({\n      offset: (pagination.current - 1) * this.state.pagination.pageSize,\n      sort: _objectSpread(_objectSpread({}, sort), {}, {\n        sortBy: sorter.field,\n        sorter: sorter.order === 'ascend' ? 'asc' : 'desc'\n      })\n    });\n    this.getList();\n  }\n\n  async handleFilter(filter) {\n    await this.setState({\n      filter: filter\n    });\n    this.getList();\n  }\n\n  async setDateRanger(_, dateStrings) {\n    if (!dateStrings[0] && !dateStrings[1]) {\n      await this.setState({\n        query: {},\n        sort: {\n          sortBy: 'createdAt',\n          sorter: 'desc'\n        }\n      });\n      this.getList();\n    }\n\n    if (dateStrings[0] && dateStrings[1]) {\n      await this.setState({\n        query: {\n          fromDate: dateStrings[0],\n          toDate: dateStrings[1]\n        }\n      });\n      this.getList();\n    } else {\n      return;\n    }\n  }\n\n  render() {\n    const {\n      data,\n      loading,\n      pagination\n    } = this.state;\n    const statuses = [{\n      text: 'All',\n      key: ''\n    }, {\n      text: 'Pending',\n      key: 'pending'\n    }, {\n      text: 'Resolved',\n      key: 'resolved'\n    }, {\n      text: 'Rejected',\n      key: 'rejected'\n    }, {\n      text: 'Done',\n      key: 'done'\n    }];\n    return __jsx(React.Fragment, null, __jsx(Head, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 9\n      }\n    }, __jsx(\"title\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 11\n      }\n    }, \"payout request\")), __jsx(BreadcrumbComponent, {\n      breadcrumbs: [{\n        title: 'Payout Request'\n      }],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 9\n      }\n    }), __jsx(Page, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }\n    }, __jsx(SearchFilter, {\n      notWithKeyWord: true,\n      statuses: statuses,\n      onSubmit: this.handleFilter.bind(this),\n      searchWithPerformer: true,\n      withDatePicker: true,\n      setDateRanger: this.setDateRanger.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 11\n      }\n    }), __jsx(\"div\", {\n      style: {\n        marginBottom: '20px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 11\n      }\n    }), data ? __jsx(PayoutRequestTable, {\n      data: data,\n      loading: loading,\n      rowKey: \"_id\",\n      pagination: pagination,\n      onChange: this.onHandleTabChange.bind(this),\n      updateStatus: this.updateStatus.bind(this),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 13\n      }\n    }) : __jsx(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 13\n      }\n    }, \"No request found.\")));\n  }\n\n}\n\nexport default PayoutRequestPage;","map":null,"metadata":{},"sourceType":"module"}